<div class="leftbar {{ selectedTheme }}" [ngStyle]="{width: leftbarWidth + 'px'}" (click)="closeContextMenu()">
  <div class="leftbar-splitter" [ngStyle]="{left: leftbarWidth + 'px'}" (click)="isResized = !isResized"></div>

  <div class="leftbar__user-card">
    <div class="leftbar__user-ico">
      <img src="../assets/img/ZKoQpzcDggWg2ogpkHjR9JnzY9lbPC7wR_gI-BZX5ncn7VOpt-G_a2jJmQBzC4gx.jpg" alt="alt" />
    </div>

    <div class="leftbar__current-info">
      <div class="leftbar__user-name">
        <p>Андрей Дарий</p>
      </div>

      <div class="leftbar__user-role">
        <p>Разработчик</p>
      </div>
    </div>

    <div class="leftbar__options pointer" title="Настройки" (click)="hideOptions = !hideOptions">
      <svg
        width="27"
        height="18"
        viewBox="0 0 27 18"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        [ngClass]="{active: !hideOptions}">
        <path
          d="M1.5 17H25.5M1 9H25M1 1H25"
          stroke="white"
          stroke-opacity="0.3"
          stroke-width="2"
          stroke-miterlimit="1.30541"
          stroke-linecap="round"
          stroke-linejoin="round"
          [ngClass]="{'active-stroke': !hideOptions}" />
      </svg>
    </div>
  </div>

  <app-main-leftbar-aside-notifi
    *ngIf="!hideNotifi"
    (hideNotifi)="hideNotifi = !hideNotifi"></app-main-leftbar-aside-notifi>

  <app-main-leftbar-aside-menu
    *ngIf="!hideOptions"
    (hideOptions)="hideOptions = !hideOptions"></app-main-leftbar-aside-menu>

  <div class="flex" (contextmenu)="openContextMenu($event)">
    <app-main-leftbar-navigation
      (notifiEmitter)="hideNotifi = !hideNotifi"
      (showCreateFolder)="showCreateFolder = !showCreateFolder"></app-main-leftbar-navigation>

    <div class="leftbar__chat-container">
      <div *ngIf="showControls" class="leftbar__create-chat fade-bottom">
        <div>
          <input
            class="ez-create-input"
            type="text"
            placeholder="Введите название канала"
            (keyup.enter)="createChannel(channelName)"
            [(ngModel)]="channelName" />
        </div>

        <div class="flex-align-center">
          <button style="margin-right: 10px" class="ez-small-button" (click)="createChannel(channelName)">
            Создать
          </button>
          <button class="ez-small-button" (click)="showControls = false">Отмена</button>
        </div>
      </div>

      <div *ngIf="showSearch" class="leftbar__search fade-bottom">
        <div>
          <input class="ez-create-input" type="text" placeholder="Поиск" />
          <div class="flex-align-center">
            <button style="margin-right: 10px" class="ez-small-button">Найти</button>
            <button class="ez-small-button" (click)="showSearch = false">Отмена</button>
          </div>
        </div>
      </div>

      <div *ngIf="pinnedChats.length > 0" class="leftbar__pinned-chat">
        <div *ngFor="let item of pinnedChats">
          <div class="leftbar__chat-wrap fade-bottom">
            <div class="leftbar__chat-ico">{{ item?.ico }}</div>
            <div class="leftbar__chat" (click)="showChatSection(item)">
              <div class="flex">
                <p style="margin-right: 5px">{{ item?.name }}</p>
                <div *ngIf="item?.msgs !== 0" class="leftbar__unread-msgs">
                  {{ item?.msgs }}
                </div>
              </div>

              <div class="flex">
                <p style="margin-right: 5px; white-space: nowrap">{{ item?.userName + ': ' }}</p>
                <div class="flex">
                  <p style="margin-right: 5px; white-space: nowrap" class="leftbar__chat-last-msg">
                    {{ item?.lastMsg }}
                  </p>
                  <p>{{ item?.time }}</p>
                </div>
              </div>
            </div>

            <div class="flex">
              <div (click)="unpinChannel(item)">&#9733;</div>
              <div class="X">&times;</div>
            </div>
          </div>
        </div>
      </div>

      <div *ngFor="let item of chats" class="leftbar__chat-wrap fade-bottom">
        <div class="leftbar__chat-ico">{{ item?.ico }}</div>
        <div class="leftbar__chat" (click)="showChatSection(item)">
          <div class="flex">
            <p style="margin-right: 5px">{{ item?.name }}</p>
            <div *ngIf="item?.msgs !== 0" class="leftbar__unread-msgs">
              {{ item?.msgs }}
            </div>
          </div>

          <div class="flex">
            <p style="margin-right: 5px; white-space: nowrap">{{ item?.userName + ': ' }}</p>
            <div class="flex">
              <p style="margin-right: 5px; white-space: nowrap" class="leftbar__chat-last-msg">{{ item?.lastMsg }}</p>
              <p>{{ item?.time }}</p>
            </div>
          </div>
        </div>

        <div class="flex">
          <div (click)="pinChannel(item)">&#9734;</div>
          <div class="X" (click)="openPopup(item)">&times;</div>
        </div>
      </div>
    </div>
  </div>

  <div
    *ngIf="!hideContextMenu"
    class="ez-context-menu"
    [ngStyle]="{
      top: contextMenuPosition?.y + 'px',
      left: contextMenuPosition?.x + 'px'
    }">
    <p class="ez-context-menu__item" (click)="showSearch = true">Поиск</p>
    <p class="ez-context-menu__item" (click)="showControls = true">Создать канал</p>
    <p class="ez-context-menu__item">Создать папку</p>
    <p class="ez-context-menu__item">Закрепить канал</p>
    <p class="ez-context-menu__item" routerLink="/options">Перейти в настройки</p>
    <p class="ez-context-menu__item">Удалить канал</p>
  </div>
</div>

<popup [popupData]="popupData" [showPopup]="showPopup"></popup>
